# Week1 Chapter1~3

생성일: 2022년 1월 17일 오후 1:41

# Chapter1 아파치 스파크란

- 아파치 스파크는 통합 컴퓨터 엔진이며 클러스터 환경에서 데이터를 병렬로 처리하는 라이브러리 집합
- 스파크는 널리 쓰이는 파이썬, 자바, 스칼라, R을 지원하며 SQL뿐만 아니라 스트리밍, 머신러닝에 이르기까지 넓은 범위의 라이브러리를 제공
- 스파크는 데이터 저장 위치에 상관없이 처리에 집중하도록 제작되었고 빅데이터 분석 업무의 표준이 되었음
- 기존 맵리듀스 엔진 기반 애플리케이션은 효율성이 낮아 이를 해결하기 위해 스파크에서는 애플리케이션을 간결하게 개발할 수 있는 함수형 프로그래밍 기반의 API를 설계
- 스파크가 제공하는 조합형 API의 핵심 아이디어
    - 초기버전: 함수형 연산 - 자바 객체로 이루어진 컬렉션에 맵이나 리듀스 같은 병렬 연산을 수행하는 방식
    - 1.0버전: 구조화된 데이터를 기반으로 동작하는 신규 API인 SQL
    - 이후 DataFrame, 머신러닝 파이프라인 그리고 구조체 기반 신규 API도 추가

# Chapter2 스파크 간단히 살펴보기

- 스파크는 컴퓨터 클러스터의 데이터 처리 작업을 관리하고 조율
- 스파크가 연산에 사용할 클러스터는 스파크 standalone 클러스터 매니저, 하둡 YARN, Mesos 같은 클러스터 매니저에서 관리
- 사용자는 클러스터 매니저에 스파크 애플리케이션을 submit
- 클러스터 매니저는 애플리케이션 실행에 필요한 자원을 할당하며 작업을 처리

## 스파크 애플리케이션

- 드라이버 프로세스: 스파크 애플리케이션 정보의 유지 관리, 사용자 프로그램이나 입력에 대한 응답, 전반적인 익스큐터 프로세스의 작업과 관련된 분석, 배포 그리고 스케줄링 역할 수행
- 익스큐터: 드라이버 프로세스가 할당한 작업을 수행
- 스파크는 사용 가능한 자원을 파악하기 위해 클러스터 매니저를 사용

cf) 스파크는 클러스터 모드 뿐 아니라 로컬 모드도 진행.

## SparkSession

- 스파크 애플리케이션은 SparkSession이라 불리는 드라이버 프로세스로 제어
- SparkSession 인스턴스는 사용자가 정의한 처리 명령을 클러스터에서 실행하고 하나의 SparkSession은 하나의 스파크 애플리케이션에 대응

## DataFrame

- 스키마(Schema): 컬럼과 컬럼의 타입을 정의한 목록
- 스파크 DataFrame은 수천 대의 컴퓨터에 분산되어 있음.
- 스파크는 모든 익스큐터가 병렬로 작업을 수행할 수 있도록 파티션이라 불리는 청크 단위로 데이터를 분할
    - 파티션은 클러스터의 물리적 머신에 존재하는 로우의 집합
    - DataFrame을 사용하면 파티션을 수동 혹은 개별적으로 처리할 필요가 없음

## Transformation

- 스파크의 핵심 데이터 구조는 immutable
- DataFrame을 변경하려면 Transformation을 해야 함
- Transformation에는 두 가지 유형이 있음
    - 좁은 의존성: 각 입력 파티션이 하나의 출력 파티션에만 영향을 미침
    - 넓은 의존성: 하나의 입력 파티션이 여러 출력 파티션에 영향을 미침
- 좁은 Transformation을 사용하면 스파크에서 piplelining을 자동으로 수행
- 스파크가 클러스터에서 파티션을 교환하는 “shuffle” → 그 결과는 디스크에 저장

## 지연 연산

- 스파크는 특정 연산 명령이 내려진 즉시 데이터를 수정하지 않고 워시 데이터에 적용할 transformation의 실행 계획을 생성
- 이를 바탕으로 전체 데이터 흐름을 최적화!

## 액션

- 일련의 트랜스포메이션으로부터 결과를 계산하도록 지시하는 명령
- 액션을 지정하면 스파크 잡이 시작

# Chapter 3 스파크 기능 둘러보기

## 운영용 애플리케이션 실행

- 스파크는 spark-submit명령을 사용해 대화형 셀에서 개발한 프로그램을 운영용 애플리케이션으로 쉽게 전환 가능

## 구조적 API

- Dataset은 정적 타입 코드를 지원하기 위해 고안된 스파크의 구조적 API
- 자바와 스칼라의 정적 데이터 타입에 맞는 코드를 위한 것이므르ㅗ 동적 타입 언어인 파이썬과 R에서는 사용 불가
- Dataset API는 타입 안정성을 지원하므로 초기화에 사용한 클래스 대신 다른 클래스로 접근할 수 없음

## 구조적 스트리밍

- 구조적 API로 개발된 배치 모드의 연산을 스트리밍 방식으로 실행할 수 있으며, 지연 시간을 줄이고 증분 처리할 수 있음
- 기존 스파크 스트리밍의 단점을 보완할 수 있음

## 저수준 API

- 스파크는 RDD를 통해 자바와 파이썬 객체를 다루는 데 필요한 다양한 저수준 API를 제공
- RDD를 이용해 파티션과 같은 물리적 실행 특성을 결정할 수 있어 DataFrame보다 더 세밀한 제어를 할 수 있음