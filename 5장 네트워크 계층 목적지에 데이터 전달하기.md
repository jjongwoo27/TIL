# 5장 네트워크 계층: 목적지에 데이터 전달하기

생성일: 2022년 1월 7일 오전 11:35
태그: 모두의Network

# 네트워크 계층의 역할

- 수많은 네트워크가 연결된 환경에서 데이터 링크 계층의 기능만으로는 다른 네트워크로 데이터를 전송하기 힘들다.
- 라우터 : 네트워크 간의 통신을 가능하게 하는 장비
    - 데이터의 목적지가 정해지면 해당 목적지까지 어떤 경로로 가는 것이 좋은지를 알려 주는 기능.
    - 이때, 필요한 목적지의 주소를 “IP주소”라고 함.
    - 라우팅 테이블: 경로 정보를 등록하고 관리
- IP주소: 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있도록 하는 주소
- 라우팅: 목적지 IP주소까지 어떤 경로로 데이터를 보낼지 결정하는 것.
- 네트워크 계층에서는 캡슐화할 때 IP헤더를 붙인다.
    - 버전(version), 헤더 길이(header length), 서비스 유형(service type), 전체 패킷 길이(total length), ID(identification), 조각 상태(flags), 조각의 위치(fragment offset), TTL, 프로토콜(protocol), 헤더 체크섬(header checksum), **출발지 IP 주소(source IP address), 목적지 IP 주소(destination IP address)** 순으로 IP헤더가 구성
    - 이렇게 만들어진 것을 IP패킷이라고 함.

# IP주소의 구조

- IP주소는 인터넷 서비스 제공자(ISP)에게 받을 수 있음.
    - IPv4: 32비트 → 43억개
    - IPv6: 128비트 → 엄청나게 많은 개수. IPv4로 만들 수 있는 IP주소가 부족한 문제 해결
- 공인 IP주소는 사용할 수 있는 숫자가 제한되므로 컴퓨터 한 대당 공인 IP주소를 하나씩 할당하기가 어려움. 따라서 ISP가 제공하는 공인 IP 주소는 라우터에만 할당하고 랜 안에 있는 컴퓨터에는 랜의 네트워크 관리자가 자유롭게 사설 IP 주소를 할당하거나 라우터의 DHCP 기능을 사용하여 주소를 자동으로 할당.
- IP주소는 10진수로 표현하지만 실제로는 2진수로 되어 있다.
    - 32비트를 8비트씩 끊어서 네 개의 옥텟으로 구분하고 숫자의 범위도 정해져 있음
- IP주소는 네트워크ID와 호스트ID로 나눠져 있음.
    - 네트워크ID: 어떤 네트워크인지를 나타냄
    - 호스트ID: 해당 네트워크의 어느 컴퓨터인지를 나타냄

# IP주소의 클래스 구조

- IPv4의 IP주소는 32비트이지만 네트워크ID를 크게 만들거나 호스트ID를 작게 만들어 네트워크 크기를 조정할 수도 있음.
    - 이때 네트워크 크기는 클래스라는 개념으로 구분
- 클래스는 A~E클래스로 나뉨.
    - 일반 네트워크에서는 A~C클래스까지 사용 가능.

## A 클래스

- 처음 8비트가 네트워크ID고 다음 24비트가 호스트ID
- 공인IP주소의 범위
    - 1.0.0.0~9.255.255.255
    - 11.0.0.0~126.255.255.255
- 사설IP주소의 범위
    - 10.0.0.0~10.255.255.255

## B 클래스

- 처음 16비트가 네트워크ID고 다음 16비트가 호스트ID
- 공인IP주소의 범위
    - 128.0.0.0~172.15.255.255
    - 172.32.0.0~191.255.255.255
- 사설IP주소의 범위
    - 172.16.0.0~172.31.255.255

## C 클래스

- 처음 24비트가 네트워크ID고 다음 8비트가 호스트ID
- 공인IP주소의 범위
    - 192.0.0.0~192.167.255.255
    - 192.169.0.0~223.255.255.255
- 사설IP주소의 범위
    - 192.168.0.0~192.168.255.255

# 네트워크 주소와 브로드캐스트 주소의 구조

- 네트워크 주소는 전체 네트워크에서 작은 네트워크를 식별하는 데 사용
    - 전체 네트워크의 대표 주소
- 브로드캐스트 주소는 네트워크에 있는 컴퓨터나 장비 모두에게 하번 데이터를 전송하는 데 사용되는 전용 IP 주소
    - 전체 네트워크에 데이터를 전송하려면 호스트 ID에 255를 설정하면 됨.
- 네트워크 주소와 브로드캐스트 주소는 자신의 IP 주소로 설정하면 안 된다.

# 서브넷의 구조

- 네트워크 내의 많은 수의 컴퓨터가 브로드캐스트 패킷을 전송하면 모든 컴퓨터에 패킷이 전송되고 네트워크가 혼잡해짐
- 서브네팅: A클래스의 대규모 네트워크를 작은 네트워크로 분할하여 브로드캐스트로 전송되는 패킷의 범위를 좁힘.
    
    → 원래 호스트ID로 사용되던 비트를 서브넷ID와 호스트ID로 분할.
    
- IP주소를 서브넷팅하면 어디까지가 네트워크ID이고 어디부터가 호스트ID인지 판단하기가 어려울 때가 있다.
- 서브넷 마스크: 네트워크 ID와 호스트ID를 식별하기 위한 값.
    - 프리픽스 표기법을 사용하여 서브넷 카스크를 슬래시(비트)로 나타낸다. ex) /24

cf)

- 멀티캐스트: 한 컴퓨터(호스트)에서 패킷을 여러 컴퓨터로 동시에 전송
- 브로드캐스트: IP네트워크에 있는 모든 컴퓨터(호스트)로 데이터를 전송

# 라우터의 구조

- 서로 다른 네트워크와 통신하려면 라우터가 필요하다.
- 라우터는 네트워크를 분할 할 수 있다. (스위치와 허브는 불가능)
- 컴퓨터에서 다른 네트워크로 데이터를 전송하려면 기본 게이트웨이를 설정해야 한다.
- 라우팅은 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 방식
- 경로 정보가 등록되어 있는 테이블을 라우팅 테이블이라 한다.
- 라우터 간에 라우팅 정보를 서로 교환하기 위한 프로토콜을 라우팅 프로토콜이라 한다.
    - ex) RIP, OSPF, BGP