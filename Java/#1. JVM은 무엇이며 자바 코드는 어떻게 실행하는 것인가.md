# #1. JVM은 무엇이며 자바 코드는 어떻게 실행하는 것인가

생성일: 2022년 1월 3일 오후 3:25
태그: Java

# Overview

## 학습 목표

<aside>
🔥 자바 소스 파일(.java)을 JVM으로 실행하는 과정 이해하기.

</aside>

- JVM이란 무엇인가
- 컴파일 하는 방법
- 실행하는 방법
- 바이트코드란 무엇인가
- JIT 컴파일러란 무엇이며 어떻게 동작하는지
- JVM 구성 요소
- JDK와 JRE의 차이
    
    [[ Java ] JDK, JRE 차이점(JDK란? JRE란?)](https://developerntraveler.tistory.com/49)
    

# JVM의 구성 요소

## JVM이란?

- JVM은 ‘Java Virtual Machine’을 줄인 것으로 ‘자바를 실행하기 위한 가상 머신’
- 자바로 작성된 어플리케이션은 모두 이 JVM에서만 실행된다.
- JVM은 자바와 OS 사이에서 중계자 역할을 하며, 자바가 운영체제 종류에 영향을 받지 않고 실행 가능하도록 한다.
- JVM은 운영체제 위에서 동작하는 프로세스로 자바 코드를 컴파일 해서 얻은 바이트 코드를 해당 운영체제가 이해할 수 있는 기계어로 바꿔실행 시켜주는 역할을 한다.
- 즉, JVM은 시스템 메모리를 관리(Garbage Collection)하면서 자바 기반의 애플리케이션을 위해 이식 가능한 실행 환경을 제공한다.

## 구성 요소

![Untitled](#1%20JVM%E1%84%8B%E1%85%B3%E1%86%AB%20%E1%84%86%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%BA%E1%84%8B%E1%85%B5%E1%84%86%E1%85%A7%20%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%8B%E1%85%A5%E1%84%84%E1%85%A5%E1%87%82%E1%84%80%E1%85%A6%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%92%E1%85%A2%E1%86%BC%E1%84%92%E1%85%A1%E1%84%82%20d784d12e4f6e4c13832088d9d8b6c06f/Untitled.png)

### **JVM 자바 클래스 로더 (Class Loader)**

모든 자바 애플리케이션은 하나 또는 수많은 클래스로 구성되어 있다. 그러한 자바 애플리케이션을 실행하기 위해서는, 컴파일된 .class 파일을 JVM 내로 로드(Load)하고 링크를 통해 배치해야 한다. 이 역할을 하는 것이 바로 JVM 자바 클래스 로더이다.

### **JVM 실행 엔진 (Execution Engine)**

JVM 실행에 필수적인 실행 엔진으로, Interpreter(인터프리터)와 JIT(Just-In-Time) 컴파일러 등의 방식을 사용하여 바이트 코드(.class 파일)를 JVM 내부의 기계가 읽고 실행할 수 있는 형태로 변경한다.

### **Interpreter (인터프리터)**

인터프리터 방식은 JVM 실행 엔진이 바이트 코드를 '명령어 단위'로 읽어서 실행한다.

### **JIT (Just-In-Time)**

인터프리터 방식으로 실행하다가 적절한 시점에 바이트 코드 전체를 컴파일하여 native 코드로 변경하고, 이후에는 더 이상 인터프리팅 하지 않고 네이티브 코드로 직접 실행하는 방식

- 네이티브 코드는 캐시에 보관하기 때문에 한 번 컴파일된 코드는 빠르게 수행되지만, JIT 컴파일러가 컴파일하는 과정은 바이트 코드를 인터프리팅 하는 것보다 훨씬 오래걸리므로 한 번만 실행되는 코드라면 컴파일하지 않고 인터프리팅 하는 것이 유리하다.
- JIT 컴파일러를 사용하는 JVM들은 내부적으로 특정 메서드가 얼마나 자주 수행되는지 체크하고, 일정 정도를 넘을 때에만 컴파일을 수행한다.

### Garbage Collector

메모리를 관리할 때는 메모리를 할당하거나 사용하지 않지만 할당되어 있는 메모리를 해제한다.

### **Runtime Data Area**

프로그램을 수행하기 위해 아래 그림처럼 운영체제로부터 할당받은 메모리 공간

# Java 컴파일 및 실행

## 바이너리코드 - 바이트코드

- 바이너리 코드는 컴퓨터가 인식할 수 있는 0과 1로 구성된 이진코드를 의미한다.
- 바이트 코드는 CPU가 아닌 가상 머신에서 이해할 수 있는 코드를 위한 이진 표현법이다. 즉, 가상 머신이 이해할 수 있는0과 1로 구성된 이진코드를 의미한다.
- Java에서는 컴파일러(javac)에 의해 소스파일(*.java)이 목적파일(*.class)로 변환될때 컴퓨터가 바로 인식할 수 있는 바이너리코드가 아닌 바이트 코드로 변환된다.

## JDK와 JRE

JDK는 JRE를 포함한 것이다.

![Untitled](#1%20JVM%E1%84%8B%E1%85%B3%E1%86%AB%20%E1%84%86%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%BA%E1%84%8B%E1%85%B5%E1%84%86%E1%85%A7%20%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%20%E1%84%8F%E1%85%A9%E1%84%83%E1%85%B3%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%8B%E1%85%A5%E1%84%84%E1%85%A5%E1%87%82%E1%84%80%E1%85%A6%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%92%E1%85%A2%E1%86%BC%E1%84%92%E1%85%A1%E1%84%82%20d784d12e4f6e4c13832088d9d8b6c06f/Untitled%201.png)

- JDK : Java를 사용하기 위해 필요한 모든 기능을 갖춘 Java용 SDK(Software Development Kit)이다.
- JRE : JVM, Java Class Library, Java Command 및 기타 인프라를 포함한 컴파일된 Java 프로그램을 실행하는데 필요한 패키지

## 자바 컴파일 과정

1. 개발자가 자바 소스코드(.java)를 작성
2. 자바 컴파일러(Java Compiler)가 자바 소스파일을 컴파일
    1. 이때 나오는 파일은 자바 바이트 코드(.class)파일로 아직 컴퓨터가 읽을 수 없는 자바 가상 머신이 이해할 수 있는 코드
    2. 바이트 코드의 각 명령어는 1바이트 크기의 Opcode와 추가 피연산자로 이루어져있음.
3. 컴파일된 바이크 코드를 JVM의 클래스로더(Class Loader)에게 전달
4. 클래스 로더는 동적로딩(Dynamic Loading)을 통해 필요한 클래스들을 로딩 및 링크하여 런타임 데이터 영역(Runtime Data area), 즉 JVM의 메모리에 올림
5. 실행엔진(Execution Engine)은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와서 실행

**참고**

자바의 정석 chapter1

[https://siahn95.tistory.com/entry/Java-JVM이란-3-JVM의-두-가지-구성-요소](https://siahn95.tistory.com/entry/Java-JVM%EC%9D%B4%EB%9E%80-3-JVM%EC%9D%98-%EB%91%90-%EA%B0%80%EC%A7%80-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C)

[https://shrtorznzl.tistory.com/82](https://shrtorznzl.tistory.com/82)

[https://developerntraveler.tistory.com/49](https://developerntraveler.tistory.com/49)